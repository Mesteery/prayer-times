"use strict";function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,i){for(var e=0;e<i.length;e++){var a=i[e];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function _createClass(t,i,e){return i&&_defineProperties(t.prototype,i),e&&_defineProperties(t,e),t}var DMath=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"dtr",value:function(t){return t*Math.PI/180}},{key:"rtd",value:function(t){return 180*t/Math.PI}},{key:"sin",value:function(t){return Math.sin(this.dtr(t))}},{key:"cos",value:function(t){return Math.cos(this.dtr(t))}},{key:"tan",value:function(t){return Math.tan(this.dtr(t))}},{key:"arcsin",value:function(t){return this.rtd(Math.asin(t))}},{key:"arccos",value:function(t){return this.rtd(Math.acos(t))}},{key:"arctan",value:function(t){return this.rtd(Math.atan(t))}},{key:"arccot",value:function(t){return this.rtd(Math.atan(1/t))}},{key:"arctan2",value:function(t,i){return this.rtd(Math.atan2(t,i))}},{key:"fixAngle",value:function(t){return this.fix(t,360)}},{key:"fixHour",value:function(t){return this.fix(t,24)}},{key:"fix",value:function(t,i){return(t-=i*Math.floor(t/i))<0?t+i:t}}]),t}(),PrayerTimes=function(){function n(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"MWL";for(var i in _classCallCheck(this,n),this._method=t,this.timeNames={imsak:"Imsak",fajr:"Fajr",sunrise:"Sunrise",dhuhr:"Dhuhr",asr:"Asr",sunset:"Sunset",maghrib:"Maghrib",isha:"Isha",midnight:"Midnight"},this.methods={MWL:{name:"Muslim World League",params:{fajr:18,isha:17}},ISNA:{name:"Islamic Society of North America (ISNA)",params:{fajr:15,isha:15}},MF:{name:"Muslims of France (MF)",params:{fajr:12,isha:12}},Egypt:{name:"Egyptian General Authority of Survey",params:{fajr:19.5,isha:17.5}},Makkah:{name:"Umm Al-Qura University, Makkah",params:{fajr:18.5,isha:"90 min"}},Karachi:{name:"University of Islamic Sciences, Karachi",params:{fajr:18,isha:18}},Tehran:{name:"Institute of Geophysics, University of Tehran",params:{fajr:17.7,isha:14,maghrib:4.5,midnight:"Jafari"}},Jafari:{name:"Shia Ithna-Ashari, Leva Institute, Qum",params:{fajr:16,isha:14,maghrib:4,midnight:"Jafari"}},JAKIM:{name:"Jabatan Kemajuan Islam Malaysia",params:{fajr:20,isha:18}}},this.defaultParams={maghrib:"0 min",midnight:"Standard"},this.setting={imsak:"10 min",dhuhr:"0 min",asr:"Standard",highLats:"NightMiddle"},this.timeFormat="24h",this.timeSuffixes=["am","pm"],this.invalidTime="---",this.numIterations=1,this.offset={},this.lat,this.lng,this.elv,this.timeZone,this.jDate,this.defParams=this.defaultParams,this.methods)for(var e in this.params=this.methods[i].params,this.defParams)void 0===this.params[e]&&(this.params[e]=this.defParams[e]);for(var a in this.calcMethod=this.methods[t]?t:"MWL",this.params=this.methods[this.calcMethod].params,this.params)this.setting[a]=this.params[a];for(var s in this.timeNames)this.offset[s]=0}return _createClass(n,[{key:"adjust",value:function(t){for(var i in t)this.setting[i]=this.params[i]}},{key:"tune",value:function(){for(var t in this.timeOffsets)this.offset[t]=this.timeOffsets[t]}},{key:"getSetting",value:function(){return this.setting}},{key:"getOffsets",value:function(){return this.offset}},{key:"getDefaults",value:function(){return this.methods}},{key:"getTimes",value:function(t,i,e,a,s){return this.lat=+i[0],this.lng=+i[1],this.elv=i[2]?+i[2]:0,this.timeFormat=s||this.timeFormat,t.constructor===Date&&(t=[t.getFullYear(),t.getMonth()+1,t.getDate()]),void 0!==e&&"auto"!=e||(e=this.getTimeZone(t)),void 0!==a&&"auto"!=a||(a=this.getDst(t)),this.timeZone=+e+(+a?1:0),this.jDate=this.julian(t[0],t[1],t[2])-this.lng/360,this.computeTimes()}},{key:"getMonthTimes",value:function(t,i,e,a,s,n){for(var r=new Date(i,t+1,0).getDate(),h=[],u=1;u<=r;u++){var o=new Date(i,t,u),m={times:this.getTimes(o,e,a,s,n),date:o.getTime()};h.push(m)}return h}},{key:"getYearTimes",value:function(t,i,e,a,s){for(var n=[],r=0;r<=11;r++){var h=this.getMonthTimes(r,t,i,e,a,s);n.push(h)}return n}},{key:"getFormattedTime",value:function(t,i,e){if(isNaN(t))return this.invalidTime;if("Float"==i)return t;e=e||this.timeSuffixes,t=DMath.fixHour(t+.5/60);var a=Math.floor(t),s=Math.floor(60*(t-a)),n="12h"==i?e[a<12?0:1]:"";return("24h"==i?this.twoDigitsFormat(a):(a+12-1)%12+1)+":"+this.twoDigitsFormat(s)+(n?" "+n:"")}},{key:"midDay",value:function(t){var i=this.sunPosition(this.jDate+t).equation;return DMath.fixHour(12-i)}},{key:"sunAngleTime",value:function(t,i,e){var a=this.sunPosition(this.jDate+i).declination,s=this.midDay(i),n=1/15*DMath.arccos((-DMath.sin(t)-DMath.sin(a)*DMath.sin(this.lat))/(DMath.cos(a)*DMath.cos(this.lat)));return s+("ccw"==e?-n:n)}},{key:"asrTime",value:function(t,i){var e=this.sunPosition(this.jDate+i).declination,a=-DMath.arccot(t+DMath.tan(Math.abs(this.lat-e)));return this.sunAngleTime(a,i)}},{key:"sunPosition",value:function(t){var i=t-2451545,e=DMath.fixAngle(357.529+.98560028*i),a=DMath.fixAngle(280.459+.98564736*i),s=DMath.fixAngle(a+1.915*DMath.sin(e)+.02*DMath.sin(2*e)),n=(DMath.cos(e),DMath.cos(2*e),23.439-36e-8*i),r=DMath.arctan2(DMath.cos(n)*DMath.sin(s),DMath.cos(s))/15,h=a/15-DMath.fixHour(r);return{declination:DMath.arcsin(DMath.sin(n)*DMath.sin(s)),equation:h}}},{key:"julian",value:function(t,i,e){i<=2&&(--t,i+=12);var a=Math.floor(t/100),s=2-a+Math.floor(a/4);return Math.floor(365.25*(t+4716))+Math.floor(30.6001*(i+1))+e+s-1524.5}},{key:"computePrayerTimes",value:function(t){t=this.dayPortion(t);var i=this.setting;return{imsak:this.sunAngleTime(this.eval(i.imsak),t.imsak,"ccw"),fajr:this.sunAngleTime(this.eval(i.fajr),t.fajr,"ccw"),sunrise:this.sunAngleTime(this.riseSetAngle(),t.sunrise,"ccw"),dhuhr:this.midDay(t.dhuhr),asr:this.asrTime(this.asrFactor(i.asr),t.asr),sunset:this.sunAngleTime(this.riseSetAngle(),t.sunset),maghrib:this.sunAngleTime(this.eval(i.maghrib),t.maghrib),isha:this.sunAngleTime(this.eval(i.isha),t.isha)}}},{key:"computeTimes",value:function(){for(var t={imsak:5,fajr:5,sunrise:6,dhuhr:12,asr:13,sunset:18,maghrib:18,isha:18},i=1;i<=this.numIterations;i++)t=this.computePrayerTimes(t);return(t=this.adjustTimes(t)).midnight="Jafari"==this.setting.midnight?t.sunset+this.timeDiff(t.sunset,t.fajr)/2:t.sunset+this.timeDiff(t.sunset,t.sunrise)/2,t=this.tuneTimes(t),this.modifyFormats(t)}},{key:"adjustTimes",value:function(t){var i=this.setting;for(var e in t)t[e]+=this.timeZone-this.lng/15;return"None"!=i.highLats&&(t=this.adjustHighLats(t)),this.isMin(i.imsak)&&(t.imsak=t.fajr-this.eval(i.imsak)/60),this.isMin(i.maghrib)&&(t.maghrib=t.sunset+this.eval(i.maghrib)/60),this.isMin(i.isha)&&(t.isha=t.maghrib+this.eval(i.isha)/60),t.dhuhr+=this.eval(i.dhuhr)/60,t}},{key:"asrFactor",value:function(t){return{Standard:1,Hanafi:2}[t]||this.eval(t)}},{key:"riseSetAngle",value:function(){return.833+.0347*Math.sqrt(this.elv)}},{key:"tuneTimes",value:function(t){for(var i in t)t[i]+=this.offset[i]/60;return t}},{key:"modifyFormats",value:function(t){for(var i in t)t[i]=this.getFormattedTime(t[i],this.timeFormat);return t}},{key:"adjustHighLats",value:function(t){var i=this.setting,e=this.timeDiff(t.sunset,t.sunrise);return t.imsak=this.adjustHLTime(t.imsak,t.sunrise,this.eval(i.imsak),e,"ccw"),t.fajr=this.adjustHLTime(t.fajr,t.sunrise,this.eval(i.fajr),e,"ccw"),t.isha=this.adjustHLTime(t.isha,t.sunset,this.eval(i.isha),e),t.maghrib=this.adjustHLTime(t.maghrib,t.sunset,this.eval(i.maghrib),e),t}},{key:"adjustHLTime",value:function(t,i,e,a,s){var n=this.nightPortion(e,a),r="ccw"==s?this.timeDiff(t,i):this.timeDiff(i,t);return(isNaN(t)||n<r)&&(t=i+("ccw"==s?-n:n)),t}},{key:"nightPortion",value:function(t,i){var e=this.setting.highLats;return("OneSeventh"==e?1/7:"AngleBased"==e?1/60*t:.5)*i}},{key:"dayPortion",value:function(t){for(var i in t)t[i]/=24;return t}},{key:"getTimeZone",value:function(t){var i=t[0],e=this.gmtOffset([i,0,1]),a=this.gmtOffset([i,6,1]);return Math.min(e,a)}},{key:"getDst",value:function(t){return+(this.gmtOffset(t)!=this.getTimeZone(t))}},{key:"gmtOffset",value:function(t){var i=new Date(t[0],t[1]-1,t[2],12,0,0,0),e=i.toGMTString();return(i-new Date(e.substring(0,e.lastIndexOf(" ")-1)))/36e5}},{key:"eval",value:function(t){return+(t+"").split(/[^0-9.+-]/)[0]}},{key:"isMin",value:function(t){return-1!=(t+"").indexOf("min")}},{key:"timeDiff",value:function(t,i){return DMath.fixHour(i-t)}},{key:"twoDigitsFormat",value:function(t){return t<10?"0"+t:t}},{key:"method",set:function(t){this.methods[t]&&(this.adjust(this.methods[t].params),this.calcMethod=t)},get:function(){return this.calcMethod}}]),n}();"undefined"!=typeof module&&void 0!==module.exports?module.exports=PrayerTimes:"function"==typeof define&&define.amd?define([],function(){return PrayerTimes}):window.PrayerTimes=PrayerTimes;